<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaoyuan.mapper.ErpPoundMapper">
	<select id="getPoundMessageByPickgoodsid" resultType="com.xiaoyuan.model.ErpPound">
		SELECT p.id,p.tare FROM tl_erp_equipment t,tl_erp_pound p,tl_erp_orders o,tl_erp_pickgoods s,tl_erp_user u,tl_erp_driver d 
		WHERE t.id =p.`equipment_id` AND o.car_order_sn =s.car_order_sn  
		and u.id = d.user_id and d.car_sn = s.pickgoods_car_sn
		AND o.`id` = #{pickgoods_id} AND o.`status`=1
	</select>
	
	<select id="getPound" resultType="com.xiaoyuan.model.ErpPound">
		SELECT 
		  pd.`createtime`,o.`order_sn` AS order_sn,pd.`car_sn`,u.user_name AS user_name,p.`goods_name` AS goods_name,p.`supplier_spec` AS supplier_spec,a.`user_company_name`,
		  pd.`firstdate`,pd.`seconddate`,pd.`grossweight`,pd.`netweight`,pd.`tare`,p.`goods_sn` AS goods_sn,pd.squadron,o.id as o_id
		FROM
		  tl_erp_driver dr,
		  tl_erp_pickgoods p,
		  tl_erp_car c,
		  tl_erp_card d,
		  tl_erp_car_order r,
		  tl_erp_user u,
		  tl_erp_orders o,
		  tl_erp_pound pd,
		  tl_erp_user a
		WHERE dr.id = d.driver_id 
		  AND dr.id = c.driver_id 
		  AND dr.`car_sn` = p.`pickgoods_car_sn` 
		  AND u.id = dr.user_id 
		  AND o.`car_order_sn` = r.`car_order_sn` 
		  AND p.car_order_sn = r.`car_order_sn`
		  AND p.user_id = a.id
		  AND pd.`pickgoods_id` = o.id
		  AND o.`status` = 1  
		  and pd.car_sn=#{car_sn} and d.card_rfid =#{card_rfid}
	</select>
	<select id="selectByOrderSn" resultType="com.xiaoyuan.model.ErpPound">
		SELECT * FROM tl_erp_pound WHERE pickgoods_id = #{orderSn}
	</select>

	<insert id="insert">
		insert into tl_erp_pound
		(id,pickgoods_id,grossweight,tare,netweight,firstdate,seconddate,createtime,status,equipment_id,car_sn,card_rfid,squadron) 
		values
		(#{id},#{pickgoods_id},#{grossweight},#{tare},#{netweight},#{firstdate},#{seconddate},#{createtime},#{status},#{equipment_id},#{car_sn},#{card_rfid},#{squadron})
	</insert>
</mapper>