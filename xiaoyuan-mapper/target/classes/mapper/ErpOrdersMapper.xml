<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xiaoyuan.mapper.ErpOrdersMapper">
	<select id="orderslist" resultType="com.xiaoyuan.model.ErpOrders">
		SELECT o.id, o.order_sn,u.`user_company_name` AS company_name,r.car_order_address,o.createtime 
		FROM tl_erp_car_order r,tl_erp_pickgoods p ,tl_erp_driver d,tl_erp_user u,tl_erp_orders o
		WHERE    d.car_sn = p.pickgoods_car_sn  AND p.car_order_sn = r.car_order_sn AND p.user_id = u.id
		and o.car_order_sn = p.car_order_sn
		and o.status = 0
		and o.car_order_sn = #{car_order_sn}
	</select>
	
	<insert id="insert">
		insert into tl_erp_orders
		(order_sn,car_order_sn,createtime,status)
		values
		(#{order_sn},#{car_order_sn},#{createtime},#{status}) 
	</insert>
	
	<select id="whitelist" resultType="com.xiaoyuan.model.ErpOrders">
		SELECT dr.`car_sn` as car_sn, s.updatetime,endtime FROM tl_erp_orders s,tl_erp_pickgoods p,tl_erp_driver dr
		WHERE dr.`car_sn` = p.`pickgoods_car_sn` 
		AND s.`car_order_sn`=p.`car_order_sn` 
		AND s.updatetime IS NOT NULL
	</select>
</mapper>